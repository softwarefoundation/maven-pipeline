on:
  push:
    branches: [ "develop" ]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
      - name: Checkout repositório
        uses: actions/checkout@v4
        with:
          ref: develop
      - name: Atualizando versão no pom.xml
        run: |
          grep -E '<version>[0-9]+\.[0-9]+\.[0-9]+</version>' pom.xml
          git config user.email dherkyan@gmail.com
          git config user.name 'CI Automation'
          git pull --rebase
          sed -E 's/(<version>)([0-9]+\.[0-9]+\.)([0-9]+)(<\/version>)/echo "\1\2$((\3+1))\4"/ge' pom.xml
          git add pom.xml
          git log --oneline -10
          git commit --amend --no-edit
          git push origin develop
          grep -E '<version>[0-9]+\.[0-9]+\.[0-9]+</version>' pom.xml
